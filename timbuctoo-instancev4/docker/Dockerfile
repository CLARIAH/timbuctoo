FROM java:8

COPY ./appassembler /root/appassembler
COPY run.sh /root/
COPY config.yaml /root/

#so that the GUI can create input fields for these environment variables
ENV USE_DUMMY_HANDLE_SERVER true
ENV PERSISTENCE_MANAGER_PRIVATEKEYFILE ""
ENV PERSISTENCE_MANAGER_CYPHER ""
ENV PERSISTENCE_MANAGER_NAMINGAUTHORITY ""
ENV PERSISTENCE_MANAGER_PREFIX ""
ENV GELF_HOST ""
ENV GELF_PORT ""
ENV GRAPHITE_HOST ""
ENV GRAPHITE_PORT ""
ENV BASE_URI ""
ENV ACTIVEMQ_BROKER_URL ""
ENV JAVA_OPTS ""

EXPOSE 80
EXPOSE 8081
WORKDIR /root
ENTRYPOINT ["./run.sh"]
CMD ["server", "./config.yaml"]
