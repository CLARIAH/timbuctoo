<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>User_info</title>
<link href="../css/static-html.css" rel="stylesheet" type="text/css" />
</head>
<body>
	<h1 id="title">user data</h1>
	<table id="data" border="1">
		<tr>
			<th>key</th>
			<th>value</th>
		</tr>
	</table>

	<script type="text/javascript"
		src="http://code.jquery.com/jquery-1.9.1.js"></script>
	<script type="text/javascript" src="../config.js"></script>
	<script type="text/javascript">
	$(document).ready(function(){
		var accessToken = readCookie('access_token');
		$.ajax({
			url: 'http://' + window.config.serverUri + '/system/users/me',
			headers:{
				Authorization: accessToken,
				VRE_ID: "example_vre"
			},
			error: function(data){
				console.log(data);
			},			
			success:function(data){
				var table = $('#data');
				$.each(data, function(key, value){
					var tr = null;
					if(value instanceof Object){
						var subTable = $('<table>');
						$.each(value, function(subKey, subValue){
							subTable.append('<tr><td>' + subKey + '</td><td>' + subValue + '</td></tr>');
						});
															
						tr  = $('<tr>');
						var keyTd = $('<td>');						
						keyTd.append(key);
						var valueTd = $('<td>');
						valueTd.append(subTable);
						tr.append(keyTd);
						tr.append(valueTd);
					}
					else{
						tr  = '<tr><td>' + key + '</td><td>' + value + '</td></tr>';
					}
					
					table.append(tr);
				});
			},
			type: 'GET'
		});
		
		function readCookie(name) {
    		var nameEQ = name + "=";
		    var ca = document.cookie.split(';');
		    for(var i=0;i < ca.length;i++) {
		        var c = ca[i];
		        while (c.charAt(0)==' ') c = c.substring(1,c.length);
		        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
		    }
		    return null;
		}
	});
</script>
</body>
</html>